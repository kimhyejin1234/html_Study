<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body onload="init()">
    <form>
        <fieldset>
            <legend>Progrsss연습</legend>
            <label for="s1">Progrsss:</label>
            <progress value="0.05" max="1" id="s1" name="s1">
                브라우저가 progress 를 지원하지 않습니다.
            </progress>
            <span>5</span>% <!--앞서 배운 output 으로 해도 좋은 방법이다-->

            <button type="submit">보내기</button>
            
        </fieldset>
    </form>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
    <script>
        let inter = null; //인터벌 객체를 저장할 변수
        //인터벌 객체란 지정한 시간만큼 간격을 두고 지정한 함수를 단 한번 호출한다

        function init(){
            //0.5초 간격으로 pGo()라는 함수를 딱! 한번 호출하는 객체 생성!
            inter = setTimeout("pGo()",500);  //1000 : 1초 , 500 : 0.5초
        }

        function pGo(){
            // console.log("^^");
            //현재 문서에서 아디이가 s1 인 요소를 검색하여 , 검색된 s1 의 값(value)을 
            //일정한 값으로 증가시켜야 한다.

            //1) s1 이라는 아이디를 가긴 요소 검색
            let pp = document.getElementById("s1");

            // 2)현재 문서안에 폼안에 fieldset안에 span요소 검색
            let pspan = document.querySelector("form fieldset span");
            //위를 검색한 이유는 s1 읜 값을 span 요소에도 동일하게 문자열로 표현하기 위함이다.

            // 3)s1 의 값을 조금 증가시키자
            pp.value = pp.value + 0.05; // 프로그레스바의 값을 증가시켰다

            // 4) 2)에서 검색된  span 태그의 문자열을 pp 의 값으로 변경하자!
            pspan.innerHTML = parseInt(pp.value * 100);
            console.log(pspan.innerHTML);
            // 프로그래스바의 값이 1이면 진행 완료 이므로
            // 움직이고 있던 인터벌 객체를 소멸시켜야 한다.
            if(pp.value >= 1){
                //인터벌 객체 소멸!!!!!!!!!!
                clearTimeout(inter);
                // console.log("완료!");
                alert("완료");
            }
            // setTimeout("pGo()",500); 이거는 무한루핑. 이럴거면 인터벌 객체를 사용한다
        }
    </script>
</body>
</html>